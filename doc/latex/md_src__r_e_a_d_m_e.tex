\subsection*{X-\/\+Mem\+: Extensible Memory Benchmarking Tool v1.\+05.\+01 }

The flexible open-\/source research tool for characterizing memory hierarchy throughput, latency, and power.

Originally authored by Mark Gottscho (Email\+: \href{mailto:mgottscho@ucla.edu}{\tt mgottscho@ucla.\+edu}) as a Summer 2014 intern at Microsoft Research, Redmond, W\+A.

This project is under active development. Stay tuned for more updates.

P\+R\+O\+J\+E\+C\+T R\+E\+V\+I\+S\+I\+O\+N D\+A\+T\+E\+: January 14, 2015. 

 \subsection*{L\+I\+C\+E\+N\+S\+E }

The M\+I\+T License (M\+I\+T)

Copyright (c) 2014 Microsoft

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \char`\"{}\+Software\char`\"{}), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions\+:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

T\+H\+E S\+O\+F\+T\+W\+A\+R\+E I\+S P\+R\+O\+V\+I\+D\+E\+D \char`\"{}\+A\+S I\+S\char`\"{}, W\+I\+T\+H\+O\+U\+T W\+A\+R\+R\+A\+N\+T\+Y O\+F A\+N\+Y K\+I\+N\+D, E\+X\+P\+R\+E\+S\+S O\+R I\+M\+P\+L\+I\+E\+D, I\+N\+C\+L\+U\+D\+I\+N\+G B\+U\+T N\+O\+T L\+I\+M\+I\+T\+E\+D T\+O T\+H\+E W\+A\+R\+R\+A\+N\+T\+I\+E\+S O\+F M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+T\+Y, F\+I\+T\+N\+E\+S\+S F\+O\+R A P\+A\+R\+T\+I\+C\+U\+L\+A\+R P\+U\+R\+P\+O\+S\+E A\+N\+D N\+O\+N\+I\+N\+F\+R\+I\+N\+G\+E\+M\+E\+N\+T. I\+N N\+O E\+V\+E\+N\+T S\+H\+A\+L\+L T\+H\+E A\+U\+T\+H\+O\+R\+S O\+R C\+O\+P\+Y\+R\+I\+G\+H\+T H\+O\+L\+D\+E\+R\+S B\+E L\+I\+A\+B\+L\+E F\+O\+R A\+N\+Y C\+L\+A\+I\+M, D\+A\+M\+A\+G\+E\+S O\+R O\+T\+H\+E\+R L\+I\+A\+B\+I\+L\+I\+T\+Y, W\+H\+E\+T\+H\+E\+R I\+N A\+N A\+C\+T\+I\+O\+N O\+F C\+O\+N\+T\+R\+A\+C\+T, T\+O\+R\+T O\+R O\+T\+H\+E\+R\+W\+I\+S\+E, A\+R\+I\+S\+I\+N\+G F\+R\+O\+M, O\+U\+T O\+F O\+R I\+N C\+O\+N\+N\+E\+C\+T\+I\+O\+N W\+I\+T\+H T\+H\+E S\+O\+F\+T\+W\+A\+R\+E O\+R T\+H\+E U\+S\+E O\+R O\+T\+H\+E\+R D\+E\+A\+L\+I\+N\+G\+S I\+N T\+H\+E S\+O\+F\+T\+W\+A\+R\+E. 

 \subsection*{F\+E\+A\+T\+U\+R\+E\+S }

This tool is provided as open source with the hope of being useful to the broader research and development community. Here are some of X-\/\+Mem\textquotesingle{}s features.

Flexibility\+: Easy reconfiguration for different sets of tests
\begin{DoxyItemize}
\item Cache levels
\item N\+U\+M\+A
\item Multi-\/threading
\item Forward and reverse strides
\item Sequential and random access
\item Read and write
\item 32, 64, 128, 256-\/bit width memory instructions
\end{DoxyItemize}

Extensibility\+: C++ object-\/oriented principles
\begin{DoxyItemize}
\item Supports rapid addition of new benchmark kernel routines by others
\item Example\+: stream triad algorithm, impact of false sharing, etc. are possible with minor additions
\end{DoxyItemize}

Cross-\/platform\+: Currently implemented for Windows on x86-\/64 C\+P\+Us with A\+V\+X extensions
\begin{DoxyItemize}
\item Designed to allow straightforward porting to other operating systems and I\+S\+As
\item Planning to implement G\+N\+U/\+Linux port
\end{DoxyItemize}

Memory throughput\+:
\begin{DoxyItemize}
\item Accurate measurement of sustained memory throughput to all levels of cache
\item Burst mode benchmark kernels possible (extensible!)
\end{DoxyItemize}

Memory latency\+:
\begin{DoxyItemize}
\item Accurate measurement of round-\/trip unloaded memory latency to all levels of cache
\item Loaded latency measurements planned
\end{DoxyItemize}

Memory power\+:
\begin{DoxyItemize}
\item Currently collecting D\+R\+A\+M power via custom driver exposed in Windows performance counter A\+P\+I
\item Supports custom power instrumentation without much modification
\item Thorough Documentation\+: extensive Doxygen source comments, H\+T\+M\+L, P\+D\+F docs
\end{DoxyItemize}

For feature requests, please refer to the contact information at the end of this R\+E\+A\+D\+M\+E. 

 \subsection*{R\+U\+N\+T\+I\+M\+E P\+R\+E\+R\+E\+Q\+U\+I\+S\+I\+T\+E\+S }

There are a few runtime prerequisites in order for the software to run correctly.

H\+A\+R\+D\+W\+A\+R\+E\+:


\begin{DoxyItemize}
\item Intel x86-\/64 C\+P\+U. R\+E\+C\+O\+M\+M\+E\+N\+D\+E\+D\+: Recent C\+P\+U with S\+S\+E2 and A\+V\+X extended instruction sets for improved throughput benchmarking capabilities.
\end{DoxyItemize}

W\+I\+N\+D\+O\+W\+S\+:


\begin{DoxyItemize}
\item Microsoft Windows 64-\/bit, 8.\+0 or later, Server 2012 or later.
\item Microsoft Visual C++ 2013 Redistributables (64-\/bit)
\end{DoxyItemize}

L\+I\+N\+U\+X\+:


\begin{DoxyItemize}
\item T\+B\+D 

 \subsection*{I\+N\+S\+T\+A\+L\+L\+A\+T\+I\+O\+N }
\end{DoxyItemize}

The only file that is needed to run is xmem.\+exe. It has no other dependencies aside from the system prerequisites listed above. 

 \subsection*{U\+S\+A\+G\+E }

N\+O\+T\+E\+: On Windows, make sure you run X-\/\+Mem with Administrator privileges. This is needed in order to\+:
\begin{DoxyItemize}
\item Allocate \char`\"{}large pages\char`\"{} for improved performance as well as query
\item Read performance counter data from the O\+S for reporting power (when applicable)
\item Elevate thread priority and pin threads to C\+P\+Us for improved performance and benchmarking consistency
\end{DoxyItemize}

xmem \mbox{[}options\mbox{]}

Options\+: \begin{DoxyVerb}-h, --help                Print usage and exit.

-l, --latency             Measure memory latency

-t, --throughput          Measure memory throughput

-w, --working_set_size    Working set size in KB. This must be a multiple of
                          4KB.

-n, --iterations          Iterations per benchmark test

-i, --base_test_index     Numerical index of the first benchmark, for
                          tracking unique test IDs.

-f, --output_file         Output filename to use. If not specified, no
                          output file generated.
\end{DoxyVerb}


Examples\+: \begin{DoxyVerb}xmem --help

xmem -h

xmem -t

xmem -t --latency -n10 -w524288 -f results.csv -i 101
\end{DoxyVerb}




 \subsection*{B\+U\+I\+L\+D\+I\+N\+G F\+R\+O\+M S\+O\+U\+R\+C\+E }

Before building the source, enable and disable the relevant compile-\/time options in \hyperlink{common_8h}{src/include/common.\+h}, under the section \char`\"{}\+User-\/configurable compilation configuration\char`\"{}. Please read the comments by each \#define statement to understand the context of each option.

After you have set the desired compile-\/time options, build the source. On Windows, running build-\/win.\+bat should suffice. On G\+N\+U/\+Linux, run build-\/linux.\+sh.

If you customize your build, make sure you use the \char`\"{}\+Release\char`\"{} mode for your O\+S. Do not include debug capabilities as it can dramatically affect performance of the benchmarks, leading to pessimistic results. 

 \subsection*{B\+U\+I\+L\+D P\+R\+E\+R\+E\+Q\+U\+I\+S\+I\+T\+E\+S }

There are a few software build prerequisites, depending on your platform.

W\+I\+N\+D\+O\+W\+S\+:


\begin{DoxyItemize}
\item Any version of Visual Studio 2013 64-\/bit (also known as version 12.\+0).
\item Python 2.\+7. You can obtain it at \href{http://www.python.org}{\tt http\+://www.\+python.\+org}.
\item S\+Cons build system. You can obtain it at \href{http://www.scons.org}{\tt http\+://www.\+scons.\+org}. Build tested with S\+Cons 2.\+3.\+4.
\end{DoxyItemize}

L\+I\+N\+U\+X\+:


\begin{DoxyItemize}
\item gcc with support for the C++11 standard. Tested with gcc version 4.\+8.\+2 on Ubuntu 14.\+04 L\+T\+S for x86-\/64.
\item Python 2.\+7. You can obtain it at \href{http://www.python.org}{\tt http\+://www.\+python.\+org}. On Ubuntu systems, you can install using \char`\"{}sudo apt-\/get install python2.\+7\char`\"{}. You may need some other Python 2.\+7 packages as well.
\item S\+Cons build system. You can obtain it at \href{http://www.scons.org}{\tt http\+://www.\+scons.\+org}. On Ubuntu systems, you can install using \char`\"{}sudo apt-\/get install scons\char`\"{}. Build tested with S\+Cons 2.\+3.\+4. 

 \subsection*{D\+O\+C\+U\+M\+E\+N\+T\+A\+T\+I\+O\+N B\+U\+I\+L\+D P\+R\+E\+R\+E\+Q\+U\+I\+S\+I\+T\+E\+S }
\end{DoxyItemize}

The following tools are only needed for automatically regenerating source code documentation with H\+T\+M\+L and P\+D\+F.

W\+I\+N\+D\+O\+W\+S\+:


\begin{DoxyItemize}
\item doxygen tool. You can obtain it at \href{http://www.stack.nl/~dimitri/doxygen}{\tt http\+://www.\+stack.\+nl/$\sim$dimitri/doxygen}.
\item La\+Te\+X distribution. You can get a Windows distribution at \href{http://www.miktex.org}{\tt http\+://www.\+miktex.\+org}.
\item make for Windows. You can obtain it at \href{http://gnuwin32.sourceforge.net/packages/make.htm}{\tt http\+://gnuwin32.\+sourceforge.\+net/packages/make.\+htm}. You will have to manually add it to your Windows path.
\end{DoxyItemize}

L\+I\+N\+U\+X\+:


\begin{DoxyItemize}
\item doxygen tool. You can obtain it at \href{http://www.stack.nl/~dimitri/doxygen}{\tt http\+://www.\+stack.\+nl/$\sim$dimitri/doxygen}. On Ubuntu systems, you can install with \char`\"{}sudo apt-\/get install doxygen\char`\"{}.
\item La\+Te\+X distribution. On Ubuntu systems, La\+Te\+X distributed with doxygen should actually be sufficient. You can install with \char`\"{}sudo apt-\/get install doxygen-\/latex\char`\"{}.
\item make. This should be included on any G\+N\+U/\+Linux system. 

 \subsection*{S\+O\+U\+R\+C\+E C\+O\+D\+E D\+O\+C\+U\+M\+E\+N\+T\+A\+T\+I\+O\+N }
\end{DoxyItemize}

The tool comes with built-\/in Doxygen comments in the source code, which can be used to generate both H\+T\+M\+L and La\+Te\+X --$>$ P\+D\+F documentation. Documentation is maintained under the doc/ subdirectory. To build documentation after modifying the source, run build-\/docs-\/win.\+bat on Windows, or build-\/docs-\/linux.\+sh on G\+N\+U/\+Linux systems. Note that Doxygen and a La\+Te\+X distribution must be installed on the system. 

 \subsection*{V\+E\+R\+S\+I\+O\+N C\+O\+N\+T\+R\+O\+L }

This project is under version control using git. Its master repository is hosted at \href{https://github.com/Microsoft/X-Mem.git}{\tt https\+://github.\+com/\+Microsoft/\+X-\/\+Mem.\+git}. 

 \subsection*{C\+O\+N\+T\+A\+C\+T, F\+E\+E\+D\+B\+A\+C\+K, A\+N\+D B\+U\+G R\+E\+P\+O\+R\+T\+S }

For questions, comments, criticism, bug reports, and other feedback for this software, please contact Mark Gottscho via email at \href{mailto:mgottscho@ucla.edu}{\tt mgottscho@ucla.\+edu} or via web at \href{http://www.seas.ucla.edu/~gottscho}{\tt http\+://www.\+seas.\+ucla.\+edu/$\sim$gottscho}.

For inquiries about this work while conducted at Microsoft, please contact Dr. Mohammed Shoaib at \href{mailto:mohammed.shoaib@microsoft.com}{\tt mohammed.\+shoaib@microsoft.\+com} or Dr. Sriram Govindan at \href{mailto:srgovin@microsoft.com}{\tt srgovin@microsoft.\+com}. 

 \subsection*{A\+C\+K\+N\+O\+W\+L\+E\+D\+G\+M\+E\+N\+T }

Mark Gottscho would like to thank Dr. Mohammed Shoaib of Microsoft Research and Dr. Sriram Govindan of Microsoft for their mentorship in the creation of this software. Further thanks to Dr. Bikash Sharma, Mark Santaniello, Mike Andrewartha, and Laura Caulfield of Microsoft for their contributions, feedback, and assistance. Finally, thank you to Dr. Jie Liu of Microsoft Research, Dr. Badriddine Khessib and Dr. Kushagra Vaid of Microsoft, and Prof. Puneet Gupta of U\+C\+L\+A for giving me the opportunity to create this work. 